apiVersion: apps/v1
kind: Deployment
metadata:
  name: tiles-caop
spec:
  replicas: 1
  selector:
    matchLabels:
      app: tiles-caop
  template:
    metadata:
      labels:
        app: tiles-caop
    spec:
      containers:
      - name: martin
        image: ghcr.io/maplibre/martin
        ports:
        - containerPort: 3000
        env:
        - name: DATABASE_URL
          valueFrom:
            secretKeyRef:
              name: db-secrets
              key: REMOTE_CAOP_URL
        - name: WATCH_MODE
          value: "true"
        command:
        - martin
        - --auto-bounds
        - calc
        - --keep-alive
        - "200"
        - --pool-size
        - "20"
        - --default-srid
        - "4326"
